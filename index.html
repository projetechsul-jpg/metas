<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Painel de Metas Projetech (Demo)</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
    body {
      font-family: 'Inter', sans-serif;
      background-color: #1a1a2e;
      color: #ffffff;
      min-height: 100vh;
    }
    .gauge {
      --progress: 0;
      position: relative;
      width: 150px;
      height: 150px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      background-image: conic-gradient(
        #4CAF50 var(--progress),
        #33334e var(--progress)
      );
      transition: background-image 0.5s ease-in-out;
    }
    .gauge::before {
      content: '';
      position: absolute;
      width: 120px;
      height: 120px;
      background-color: #1a1a2e;
      border-radius: 50%;
    }
    .gauge-value {
      position: relative;
      font-size: 2rem;
      font-weight: bold;
    }
    .chart-container {
      position: relative;
      height: 400px;
      width: 100%;
    }
    #fullscreen-btn {
      position: fixed;
      bottom: 8rem;
      right: 2rem;
      background-color: #10B981;
      color: white;
      padding: 1rem;
      border-radius: 9999px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s;
      z-index: 50;
    }
  </style>
</head>
<body class="p-8">

  <!-- Interface Principal (Dashboard) -->
  <div id="dashboard-container" class="flex flex-col items-center overflow-y-auto">
    <img src="https://placehold.co/250x60/1a1a2e/ffffff?text=Projetech" alt="Logotipo da Projetech" class="w-64 md:w-80 lg:w-96 mb-4">
    <h1 class="text-2xl sm:text-3xl md:text-4xl font-extrabold text-center mb-4">Painel de Metas Projetech - DEMO</h1>
    <p id="current-datetime" class="text-lg text-gray-400 mb-8 text-center"></p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 w-full max-w-7xl">
      <!-- Card de Metas de Faturamento -->
      <div class="bg-gray-800 p-8 rounded-2xl shadow-2xl">
        <h2 class="text-3xl font-bold mb-6 text-center">Metas de Faturamento</h2>
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 justify-items-center">
          <div class="flex flex-col items-center">
            <div id="gauge-monthly" class="gauge" style="--progress: 0%;">
              <span id="monthly-progress-text" class="gauge-value">0%</span>
            </div>
            <span id="monthly-label" class="mt-4 text-center text-sm font-bold"></span>
          </div>
          <div class="flex flex-col items-center">
            <div id="gauge-quarterly" class="gauge" style="--progress: 0%;">
              <span id="quarterly-progress-text" class="gauge-value">0%</span>
            </div>
            <span id="quarterly-label" class="mt-4 text-center text-sm font-bold"></span>
          </div>
          <div class="flex flex-col items-center">
            <div id="gauge-annual" class="gauge" style="--progress: 0%;">
              <span id="annual-progress-text" class="gauge-value">0%</span>
            </div>
            <span id="annual-label" class="mt-4 text-center text-sm font-bold"></span>
          </div>
        </div>
      </div>

      <!-- Card de Pe√ßas Mortas -->
      <div class="bg-gray-800 p-8 rounded-2xl shadow-2xl flex flex-col items-center">
        <h2 class="text-3xl font-bold mb-6 text-center">Pe√ßas Mortas</h2>
        <div class="flex flex-col items-center text-center">
          <p class="text-xl">Pe√ßas Mortas neste m√™s:</p>
          <p id="current-scrap" class="text-6xl sm:text-7xl font-bold my-4">0</p>
        </div>
      </div>
    </div>

    <div class="mt-12 w-full max-w-7xl grid grid-cols-1 lg:grid-cols-2 gap-8">
      <div class="bg-gray-800 p-8 rounded-2xl shadow-2xl">
        <h2 class="text-3xl font-bold mb-6 text-center">Evolu√ß√£o do Faturamento</h2>
        <div class="chart-container">
          <canvas id="faturamentoChart"></canvas>
        </div>
      </div>
      <div class="bg-gray-800 p-8 rounded-2xl shadow-2xl">
        <h2 class="text-3xl font-bold mb-6 text-center">Pe√ßas Mortas ao Longo do Tempo</h2>
        <div class="chart-container">
          <canvas id="scrapChart"></canvas>
        </div>
      </div>
    </div>

    <div id="history-section" class="mt-12 w-full max-w-7xl bg-gray-800 p-8 rounded-2xl shadow-2xl">
      <h2 class="text-3xl font-bold mb-6 text-center">Hist√≥rico de Dados</h2>
      <div class="overflow-x-auto">
        <table id="history-table" class="min-w-full divide-y divide-gray-700">
          <thead>
            <tr>
              <th class="px-4 py-2 text-left text-sm font-bold text-gray-400">M√™s/Ano</th>
              <th class="px-4 py-2 text-left text-sm font-bold text-gray-400">Progresso (%)</th>
              <th class="px-4 py-2 text-left text-sm font-bold text-gray-400">Pe√ßas Mortas</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-700" id="history-table-body"></tbody>
        </table>
      </div>
    </div>
  </div>

  <button id="fullscreen-btn">üì∫</button>

  <script>
    const monthlyProgressText = document.getElementById('monthly-progress-text');
    const quarterlyProgressText = document.getElementById('quarterly-progress-text');
    const annualProgressText = document.getElementById('annual-progress-text');
    const monthlyLabel = document.getElementById('monthly-label');
    const quarterlyLabel = document.getElementById('quarterly-label');
    const annualLabel = document.getElementById('annual-label');
    const currentScrap = document.getElementById('current-scrap');
    const historyTableBody = document.getElementById('history-table-body');
    const currentDatetimeElement = document.getElementById('current-datetime');
    let faturamentoChart;
    let scrapChart;

    // Dados fake
    const dataFake = [
      {month:'09', year:'2024', faturamento:150000, pecasMortas:125, metaMensal:200000, metaTrimestral:600000, metaAnual:2400000},
      {month:'08', year:'2024', faturamento:180000, pecasMortas:140, metaMensal:200000, metaTrimestral:600000, metaAnual:2400000}
    ];

    function updateGauge(gaugeId, value) {
      const gauge = document.getElementById(gaugeId);
      if (gauge) {
        const progress = Math.min(100, Math.max(0, parseFloat(value)));
        gauge.style.setProperty('--progress', `${progress}%`);
      }
    }

    function updateDashboard(data) {
      const currentMonthData = data[0];
      const previousMonthData = data[1];

      const monthlyTarget = currentMonthData.metaMensal;
      const monthlyPercent = ((currentMonthData.faturamento / monthlyTarget) * 100).toFixed(2);
      const quarterlyPercent = ((currentMonthData.faturamento / currentMonthData.metaTrimestral) * 100).toFixed(2);
      const annualPercent = ((currentMonthData.faturamento / currentMonthData.metaAnual) * 100).toFixed(2);

      monthlyProgressText.textContent = monthlyPercent + '%';
      quarterlyProgressText.textContent = quarterlyPercent + '%';
      annualProgressText.textContent = annualPercent + '%';

      updateGauge('gauge-monthly', monthlyPercent);
      updateGauge('gauge-quarterly', quarterlyPercent);
      updateGauge('gauge-annual', annualPercent);

      monthlyLabel.textContent = `Setembro de 2024`;
      quarterlyLabel.textContent = `3¬∫ Trimestre de 2024`;
      annualLabel.textContent = `2024`;

      currentScrap.textContent = currentMonthData.pecasMortas;

      // Tabela
      historyTableBody.innerHTML = '';
      data.forEach(item => {
        const progress = (item.faturamento / item.metaMensal * 100).toFixed(2);
        const row = document.createElement('tr');
        row.innerHTML = `
          <td class="px-4 py-2 text-sm">${item.month}/${item.year}</td>
          <td class="px-4 py-2 text-sm">${progress}%</td>
          <td class="px-4 py-2 text-sm">${item.pecasMortas}</td>`;
        historyTableBody.appendChild(row);
      });

      renderCharts(data);
    }

    function renderCharts(data) {
      const labels = data.map(d => `${d.month}/${d.year}`);
      const faturamentoValues = data.map(d => (d.faturamento / d.metaMensal * 100));
      const scrapValues = data.map(d => d.pecasMortas);

      const faturamentoCtx = document.getElementById('faturamentoChart').getContext('2d');
      const scrapCtx = document.getElementById('scrapChart').getContext('2d');

      if (faturamentoChart) faturamentoChart.destroy();
      if (scrapChart) scrapChart.destroy();

      faturamentoChart = new Chart(faturamentoCtx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Faturamento Mensal (%)',
            data: faturamentoValues,
            backgroundColor: 'rgba(54, 162, 235, 0.6)',
            borderColor: 'rgba(54, 162, 235, 1)',
            borderWidth: 1
          }]
        },
        options: {responsive: true, maintainAspectRatio: false}
      });

      scrapChart = new Chart(scrapCtx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: [{
            label: 'Pe√ßas Mortas',
            data: scrapValues,
            backgroundColor: 'rgba(255, 99, 132, 0.6)',
            borderColor: 'rgba(255, 99, 132, 1)',
            borderWidth: 1,
            tension: 0.3
          }]
        },
        options: {responsive: true, maintainAspectRatio: false}
      });
    }

    function updateDateTime() {
      const now = new Date();
      currentDatetimeElement.textContent = now.toLocaleString('pt-BR');
    }

    document.getElementById('fullscreen-btn').addEventListener('click', () => {
      if (document.documentElement.requestFullscreen) {
        document.documentElement.requestFullscreen();
      }
    });

    updateDashboard(dataFake);
    setInterval(updateDateTime, 1000);
    updateDateTime();
  </script>
</body>
</html>
